\doxysection{Ans\+Server.\+h}
\hypertarget{_ans_server_8h_source}{}\label{_ans_server_8h_source}\index{commonfiles20.1/PublicItf/AnsServer.h@{commonfiles20.1/PublicItf/AnsServer.h}}
\mbox{\hyperlink{_ans_server_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (C)\ 2009\ ANSYS,\ Inc.\ and\ its\ subsidiaries.\ \ All\ Rights\ Reserved.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ \$LastChangedDate\$}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ \$LastChangedRevision\$}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ \$LastChangedBy\$}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#ifndef\ \_AnsServer\_h\_}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ \_AnsServer\_h\_}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ansrpc_8h}{ansrpc.h}}>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_ans_interface_servant_8h}{AnsInterfaceServant.h}}"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_ans_i_service_registry_8h}{AnsIServiceRegistry.h}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_ans_i_connection_observer_8h}{AnsIConnectionObserver.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_ans_communication_exception_8h}{AnsCommunicationException.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_ans_service_registry_servant_8h}{AnsServiceRegistryServant.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_ans}{Ans}}\ \{}
\DoxyCodeLine{00019\ \textcolor{keyword}{namespace\ }Rpc\ \{}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server}{Server}}}
\DoxyCodeLine{00025\ \{}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{typedef}\ std::map<std::string,\ IInterfaceServant*>\ InterfaceServantMap;}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<IConnectionObserver*>\ ConnectionObserverVector;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00030\ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_af2f1305573ef7939b3e8400354878e0d}{Server}}()\ :\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}}(\mbox{\hyperlink{ansrpc_8h_af5734ef0e49da75a9d70c115e606433f}{RpcNewServer}}()),\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}}(\mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}})}
\DoxyCodeLine{00031\ \ \ \ \ \{}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_message_arg_factory_a3b4e25ab4bd05797f543b6f7551fee48}{MessageArgFactory::Initialize}}();}
\DoxyCodeLine{00033\ \ \ \ \ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a4b41a74be863b094e2c4da6ddaca0761}{\string~Server}}()}
\DoxyCodeLine{00036\ \ \ \ \ \{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_a23d28c57d110acc495844b8dcb6d4b69}{RpcDeleteServer}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}});}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}}\ !=\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}})}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}};}
\DoxyCodeLine{00040\ \ \ \ \ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_ad71b7e023ef85d35664f02f09af01eaf}{AddConnectionObserver}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_connection_observer}{IConnectionObserver}}\&\ observer)}
\DoxyCodeLine{00047\ \ \ \ \ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \_connectionObservers.push\_back(\&observer);}
\DoxyCodeLine{00049\ \ \ \ \ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_acbfde22c397a3c8fa0afb73ed47e02ba}{AddServant}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_interface_servant}{IInterfaceServant}}\&\ servant)}
\DoxyCodeLine{00055\ \ \ \ \ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a62409f922cf9a302a117554ff6a4f8cb}{\_servants}}[servant.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_interface_servant_a719dfd1c420fa56d875f3761c7672d28}{GetInterfaceName}}()]\ =\ \&servant;}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_ad5e0d77180d122162c4163f8811a329d}{RpcRegisterInterface}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ (\textcolor{keywordtype}{char}*)servant.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_interface_servant_a719dfd1c420fa56d875f3761c7672d28}{GetInterfaceName}}().c\_str(),\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a40d0eb6740a78a6bdc7db746e8ac6be7}{GetConnectionCount}}()}
\DoxyCodeLine{00064\ \ \ \ \ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{ansrpc_8h_a4ec9b17530d664f3289512017e0588b1}{RpcGetConnectionCount}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}});}
\DoxyCodeLine{00066\ \ \ \ \ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00071\ \ \ \ \ std::vector<RpcHandle>\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a9b764b922397928b3e7e8bb36ee741cd}{GetConnections}}()}
\DoxyCodeLine{00072\ \ \ \ \ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ std::vector<RpcHandle>\ connections;}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{ansrpc_8h_a59ca5f47181d4626b81011c082ccc9df}{RPC\_MAX\_CONNECTIONS}};\ i++)}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}}-\/>\mbox{\hyperlink{struct_rpc_server_ae2a2dd9ce9becfdf7721d26d6537d3ba}{Connections}}[i]\ !=\ 0)}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connections.push\_back(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}}-\/>\mbox{\hyperlink{struct_rpc_server_ae2a2dd9ce9becfdf7721d26d6537d3ba}{Connections}}[i]);}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ connections;}
\DoxyCodeLine{00080\ \ \ \ \ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a1ce4958e9dcf66d9b19ac076fe36fb6c}{GetHost}}()}
\DoxyCodeLine{00086\ \ \ \ \ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_host;}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a31266c3cbe8bb998b88d57a239349e28}{GetPort}}()}
\DoxyCodeLine{00094\ \ \ \ \ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{ansrpc_8h_a5f46054ec929d0157b3115d236462e9b}{RpcGetServerPort}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}});}
\DoxyCodeLine{00096\ \ \ \ \ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_ae58e66a967d78ee563afa2fe1cd5d09d}{GetAddress}}()}
\DoxyCodeLine{00102\ \ \ \ \ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ std::vector<std::string>\ addressVec;}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ipNum,\ i;}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ maxItfNum\ =20,\ maxLen\ =\ 20;}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ **ipList;}
\DoxyCodeLine{00107\ \ }
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ ipList\ =\ (\textcolor{keywordtype}{char}**)malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*)\ *\ maxItfNum);}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ 20;\ i++)}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ ipList[i]\ =\ (\textcolor{keywordtype}{char}*)malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char})\ *\ maxLen);}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_a17186b71278ac8ac02ae65fc70547b0c}{RpcGetServerAddress}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ \&ipList,\ \&ipNum);}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ipNum;\ i++)}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ addressVec.push\_back(ipList[i]);}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ maxItfNum;\ i++)}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ free(ipList[i]);\ }
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ free(ipList);}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ addressVec;}
\DoxyCodeLine{00123\ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00128\ \ \ \ \ \mbox{\hyperlink{struct_rpc_server}{RpcServer}}*\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_acc665783c1b7bb31430c785573f8328e}{GetRpcServer}}()}
\DoxyCodeLine{00129\ \ \ \ \ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}};}
\DoxyCodeLine{00131\ \ \ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_afb80f47b1e0ef31de0b9f9420441d3a7}{RegisterWithServiceRegistry}}(std::string\ serviceProviderName,\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_service_registry}{IServiceRegistry}}\&\ registry)}
\DoxyCodeLine{00137\ \ \ \ \ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_ans_1_1_rpc_1_1_provider_handle}{ProviderHandle}}\ serviceProvider;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ serviceProvider.\mbox{\hyperlink{struct_ans_1_1_rpc_1_1_provider_handle_adc852f586959ce13117d737cf3f14899}{Name}}\ =\ serviceProviderName;}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ serviceProvider.\mbox{\hyperlink{struct_ans_1_1_rpc_1_1_provider_handle_a9c4801d09d1e1b363caa3f06c56a3c9c}{Host}}\ =\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a1ce4958e9dcf66d9b19ac076fe36fb6c}{GetHost}}();}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ serviceProvider.\mbox{\hyperlink{struct_ans_1_1_rpc_1_1_provider_handle_a91b1a1342df7fe9e51fb5dfc4999dfe8}{Port}}\ =\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a31266c3cbe8bb998b88d57a239349e28}{GetPort}}();}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ registry.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_service_registry_a2a1ecae4868c74e8130fe69d2f3920ed}{RegisterServiceProvider}}(serviceProvider);}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa1319523d44ea021886d5fb1a2aacf78}{SetServiceRegistry}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_service_registry}{IServiceRegistry}}\&\ registry)}
\DoxyCodeLine{00150\ \ \ \ \ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}}\ !=\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}})}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}};}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_service_registry_servant}{ServiceRegistryServant}}(registry);}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_acbfde22c397a3c8fa0afb73ed47e02ba}{AddServant}}(*\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}});}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_ad71b7e023ef85d35664f02f09af01eaf}{AddConnectionObserver}}(*\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}});}
\DoxyCodeLine{00156\ \ \ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a421359ce5a99a5f836e4171b16e149e6}{\_ServeOneRequest}}(\textcolor{keywordtype}{int}\ timeout,\ \mbox{\hyperlink{ansipc_8h_aeeecc1ff73a8eb187422a4c379bf64f5}{TimeOutType}}\ toType)}
\DoxyCodeLine{00164\ \ \ \ \ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \{\ \ \ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_aa6f6cd93cb32899541b3ba2ae528e48e}{RpcHandle}}\ handle\ =\ \mbox{\hyperlink{ansipc_8h_aa3fcaa3cf31f00b9a41c7011c7da70ac}{ansipc\_Listen}}(0,\ timeout,\ toType);\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_af0bfe2c8569f0409602d393cd939b029}{CheckForError}}(handle);}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (handle\ ==\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}}-\/>\mbox{\hyperlink{struct_rpc_server_a481ec5a6f2ba490e93598be1c1fd4e11}{Handle}})}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_aa6f6cd93cb32899541b3ba2ae528e48e}{RpcHandle}}\ channel\ =\ OnNewConnection();}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (channel\ >\ 0)}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}}-\/>\mbox{\hyperlink{struct_rpc_server_a6d3b8ecdf9b970e8d07406595344aeef}{Mode}}\ ==\ \mbox{\hyperlink{ansrpc_8h_a813a4804d9efe150ad18f66e8538ce67aa5ddf3a6d46dafb382c86d7e81427a12}{PlayBack}})}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_ace56a87b22a604154a6d88a56ff6bb67}{RpcResetChannelRecordingAssociation}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ channel);}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{ansipc_8h_a9edbd39148de23e1eb2402156dfe0d8c}{ansipc\_GetExtData}}(handle)\ ==\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}})}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ eof\ =\ \mbox{\hyperlink{ansipc_8h_af813194998ef904df958ad6412fd3c11}{ansipc\_CheckForEof}}(handle);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (eof\ ==\ \mbox{\hyperlink{ansipc_8h_a48c8c513d6b2132c48341f19c55a61fe}{ANSIPC\_CON\_DISCONNECT\_CLEAN}}\ ||\ eof\ ==\ \mbox{\hyperlink{ansipc_8h_a8d2d0c1daf10a4cd0b10584c08ff2727}{ANSIPC\_CON\_DISCONNECT\_DIRTY}})\ \ \textcolor{comment}{//\ a\ channel\ is\ unavailable:\ closed\ by\ peer\ gracefully\ or\ client\ exits\ without\ clean\ up}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OnConnectionClosed(handle);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_af0bfe2c8569f0409602d393cd939b029}{CheckForError}}((eof\ ==\ \mbox{\hyperlink{ansipc_8h_a48c8c513d6b2132c48341f19c55a61fe}{ANSIPC\_CON\_DISCONNECT\_CLEAN}})?\ \mbox{\hyperlink{ansipc_8h_a117ec0df72022f90e6be7101f6c5f065}{ANSIPC\_ERROR\_DISCONNECT\_CLEAN}}\ :\ \mbox{\hyperlink{ansipc_8h_afe14ec5e0d3a313dffcb4efb8090bd05}{ANSIPC\_ERROR\_DISCONNECT\_DIRTY}},\ handle);\ \textcolor{comment}{//always\ throw\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OnClientRequest(handle);}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00196\ \ \ \ \ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a660f6e730c5924d7b44cea66c3892de4}{ServeOneRequest}}(\textcolor{keywordtype}{int}\ timeout=0)}
\DoxyCodeLine{00203\ \ \ \ \ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a421359ce5a99a5f836e4171b16e149e6}{\_ServeOneRequest}}(timeout,\ \mbox{\hyperlink{ansipc_8h_aeeecc1ff73a8eb187422a4c379bf64f5ae023e9264ef26f869b919716ceb68c61}{SecondTo}});}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00206\ \ \ \ \ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a5ed0105ef84230d990c06722677a2bcb}{ServeOneRequest}}(\textcolor{keywordtype}{int}\ timeout,\ \mbox{\hyperlink{ansipc_8h_aeeecc1ff73a8eb187422a4c379bf64f5}{TimeOutType}}\ toType)}
\DoxyCodeLine{00213\ \ \ \ \ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a421359ce5a99a5f836e4171b16e149e6}{\_ServeOneRequest}}(timeout,\ toType);}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00216\ \ \ \ \ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_ae7ace508ef2aa55fdbccb71ee86ae7c7}{SetLocalAccessOnly}}(\textcolor{keywordtype}{bool}\ localAccessOnly)}
\DoxyCodeLine{00223\ \ \ \ \ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_a496bc790adb9adfe12215a37ee4810d9}{RpcSetLocalAccessOnly}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ localAccessOnly\ ?\ 1\ :\ 0);}
\DoxyCodeLine{00225\ \ \ \ \ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_ac5f038c2b480cf9ef5e19e3eba8dbaf9}{Shutdown}}()}
\DoxyCodeLine{00231\ \ \ \ \ \{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_afe6475224acb7c220fcdfb3841e6392b}{RpcShutdownServer}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}});}
\DoxyCodeLine{00233\ \ \ \ \ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a7e4c390bc6ced874ce33ccad21c3ff9d}{Start}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{structport}{port}}=0)}
\DoxyCodeLine{00240\ \ \ \ \ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_af0bfe2c8569f0409602d393cd939b029}{CheckForError}}(\mbox{\hyperlink{ansrpc_8h_acf7e28c1b9127ca79b56e33af228d24e}{RpcStartServerOnPort}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ \mbox{\hyperlink{structport}{port}}));}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}*\ name;}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_af0bfe2c8569f0409602d393cd939b029}{CheckForError}}(\mbox{\hyperlink{ansrpc_8h_a584311982383b165f1e14328a82ce1ee}{RpcGetServerHost}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ \&name));}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \_host\ =\ name;}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{ansrpc_8h_a5f46054ec929d0157b3115d236462e9b}{RpcGetServerPort}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}});}
\DoxyCodeLine{00246\ \ \ \ \ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_a8012e234b4ba1c88125987f11aa6b955}{RpcRequestHandler}}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_adce102c4f225088a71978a257b8c9b47}{GetCRequestHandler}}(std::string\ name)}
\DoxyCodeLine{00251\ \ \ \ \ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{ansrpc_8h_adf15a716633a390db7d4c49a38fcac61}{RpcUInt}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}}-\/>\mbox{\hyperlink{struct_rpc_server_aa01321d342be550cc16da56f1dac1154}{InterfaceCount}};\ i++)}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (name\ ==\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}}-\/>\mbox{\hyperlink{struct_rpc_server_ae869ce59f7fd1fa11213ca2a65583992}{Interfaces}}[i].\mbox{\hyperlink{struct_rpc_interface_a30af99720e313ed8542356b333af5679}{Name}})}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}}-\/>\mbox{\hyperlink{struct_rpc_server_ae869ce59f7fd1fa11213ca2a65583992}{Interfaces}}[i].\mbox{\hyperlink{struct_rpc_interface_aa75c970683dd338a49c9cb563edfca50}{RequestHandler}};}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00258\ \ \ \ \ \}}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_interface_servant}{IInterfaceServant}}*\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aba1c00bbf03c2f72204f3d182454cd59}{GetServant}}(std::string\ name)}
\DoxyCodeLine{00261\ \ \ \ \ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ InterfaceServantMap::const\_iterator\ it\ =\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a62409f922cf9a302a117554ff6a4f8cb}{\_servants}}.find(name);}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (it\ !=\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a62409f922cf9a302a117554ff6a4f8cb}{\_servants}}.end()\ ?\ (*it).second\ :\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{00264\ \ \ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \textcolor{keyword}{private}:\ \ \ \ }
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ CallCRequestHandler(\mbox{\hyperlink{ansrpc_8h_a8012e234b4ba1c88125987f11aa6b955}{RpcRequestHandler}}\ requestHandler,\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_request}{Request}}\&\ request)}
\DoxyCodeLine{00269\ \ \ \ \ \{}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_rpc_request}{RpcRequest}}*\ rpcRequest\ =\ request.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_request_a796f825b203c3a51e42b5aac36f639de}{ToRpcRequest}}();}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_rpc_response}{RpcResponse}}*\ rpcResponse\ =\ \mbox{\hyperlink{ansrpc_8h_a1c55ee46480aa5cca4d1e4d8a0324e47}{RpcNewResponse}}(\mbox{\hyperlink{ansrpc__ftn_8h_a580b065fc8617298151ea278bfcc8647}{kRpcErrorNone}});}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*requestHandler)(rpcRequest,\ rpcResponse))}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ rpcResponse-\/>\mbox{\hyperlink{struct_rpc_response_adbfd27186bf9f0e4d18104c1fb2024c9}{ErrorCode}}\ =\ \mbox{\hyperlink{ansrpc__ftn_8h_af77ad2cf7afd12dce84b353c30128870}{kRpcErrorMethodNotFound}};}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_af0bfe2c8569f0409602d393cd939b029}{CheckForError}}(\mbox{\hyperlink{ansrpc_8h_a02e8bc89802dcfb13eb1f947523a8213}{RpcWriteResponse}}(request.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_request_a3f848fa731b0c24ec20bfa3a7902a0b4}{GetChannel}}(),\ rpcResponse));}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_a561474c73b902789b68cb6d7f5991494}{RpcDeleteRequest}}(rpcRequest);}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_af5a8648f7492ca1380a0d5384bea184b}{RpcDeleteResponse}}(rpcResponse);}
\DoxyCodeLine{00280\ \ \ \ \ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordtype}{void}\ CallServantRequestHandler(IInterfaceServant*\ servant,\ Request\&\ request)}
\DoxyCodeLine{00283\ \ \ \ \ \{}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ Response\ response;}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ servant-\/>HandleRequest(request,\ response);}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (std::exception\&\ ex)}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ response.ErrorCode\ =\ \mbox{\hyperlink{ansrpc__ftn_8h_aaae10237c327763701d77967a79c75ec}{kRpcErrorGeneral}};}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ response.AddArg<std::string>(\textcolor{keyword}{typeid}(ex).name());}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ response.AddArg<std::string>(ex.what());}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (...)}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ response.ErrorCode\ =\ \mbox{\hyperlink{ansrpc__ftn_8h_aaae10237c327763701d77967a79c75ec}{kRpcErrorGeneral}};}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ response.Write(request.GetChannel());}
\DoxyCodeLine{00302\ \ \ \ \ \}}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_aa6f6cd93cb32899541b3ba2ae528e48e}{RpcHandle}}\ OnNewConnection()}
\DoxyCodeLine{00305\ \ \ \ \ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_aa6f6cd93cb32899541b3ba2ae528e48e}{RpcHandle}}\ channel\ =\ \mbox{\hyperlink{ansrpc_8h_a9c4255757d784adc41a8473ec5d9dc76}{\_RpcAcceptServerConnection}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}});}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_af0bfe2c8569f0409602d393cd939b029}{CheckForError}}(channel);}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (channel\ >\ 0)}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ \mbox{\hyperlink{namespacenumpy_1_1f2py_1_1____main_____a7e98b8a17c0aad30ba64d47b74e2a6c1}{i}}\ <\ \_connectionObservers.size();\ \mbox{\hyperlink{namespacenumpy_1_1f2py_1_1____main_____a7e98b8a17c0aad30ba64d47b74e2a6c1}{i}}++)}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_connectionObservers[i]-\/>OnConnectionOpened(channel))}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_ab248614dedde011ca0b1308dcc2a4ef8}{\_RpcCloseServerConnection}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ channel);}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ channel;}
\DoxyCodeLine{00320\ \ \ \ \ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keywordtype}{void}\ OnConnectionClosed(\mbox{\hyperlink{ansrpc_8h_aa6f6cd93cb32899541b3ba2ae528e48e}{RpcHandle}}\ channel)}
\DoxyCodeLine{00323\ \ \ \ \ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ \mbox{\hyperlink{namespacenumpy_1_1f2py_1_1____main_____a7e98b8a17c0aad30ba64d47b74e2a6c1}{i}}\ <\ \_connectionObservers.size();\ \mbox{\hyperlink{namespacenumpy_1_1f2py_1_1____main_____a7e98b8a17c0aad30ba64d47b74e2a6c1}{i}}++)}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \_connectionObservers[i]-\/>OnConnectionClosed(channel);}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_ab248614dedde011ca0b1308dcc2a4ef8}{\_RpcCloseServerConnection}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ channel);}
\DoxyCodeLine{00328\ \ \ \ \ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ OnClientRequest(\mbox{\hyperlink{ansrpc_8h_aa6f6cd93cb32899541b3ba2ae528e48e}{RpcHandle}}\ channel)}
\DoxyCodeLine{00331\ \ \ \ \ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ Request\ request;}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ request.Read(channel);}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_a8012e234b4ba1c88125987f11aa6b955}{RpcRequestHandler}}\ requestHandler\ =\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_adce102c4f225088a71978a257b8c9b47}{GetCRequestHandler}}(request.GetInterface());}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (requestHandler\ !=\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}})}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ CallCRequestHandler(requestHandler,\ request);}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ IInterfaceServant*\ servant\ =\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aba1c00bbf03c2f72204f3d182454cd59}{GetServant}}(request.GetInterface());}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (servant\ !=\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}})}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ CallServantRequestHandler(servant,\ request);}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ Response\ response(\mbox{\hyperlink{ansrpc__ftn_8h_a927d6f3a5d8d7a1c73c2a4b0a0895487}{kRpcErrorInterfaceNotFound}});}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ response.Write(channel);}
\DoxyCodeLine{00352\ \ \ \ \ \}}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_af0bfe2c8569f0409602d393cd939b029}{CheckForError}}(\textcolor{keywordtype}{int}\ status)}
\DoxyCodeLine{00356\ \ \ \ \ \{}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_communication_exception_a8f610983aa369ee011e83e53ecf61a80}{CommunicationException::CheckForError}}(status);}
\DoxyCodeLine{00358\ \ \ \ \ \}}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_ae1a1f3fb0f7c9d675424747afd61ff40}{CheckForError}}(\textcolor{keywordtype}{int}\ status,\ \textcolor{keywordtype}{int}\ channel)}
\DoxyCodeLine{00361\ \ \ \ \ \{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_communication_exception_a8f610983aa369ee011e83e53ecf61a80}{CommunicationException::CheckForError}}(status,\ channel);}
\DoxyCodeLine{00363\ \ \ \ \ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \mbox{\hyperlink{struct_rpc_server}{RpcServer}}*\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}};}
\DoxyCodeLine{00366\ \ \ \ \ InterfaceServantMap\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a62409f922cf9a302a117554ff6a4f8cb}{\_servants}};}
\DoxyCodeLine{00367\ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_service_registry_servant}{ServiceRegistryServant}}*\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}};}
\DoxyCodeLine{00368\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00369\ \ \ \ \ std::string\ \_host;}
\DoxyCodeLine{00370\ \ \ \ \ ConnectionObserverVector\ \_connectionObservers;}
\DoxyCodeLine{00371\ \};}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \}\}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
