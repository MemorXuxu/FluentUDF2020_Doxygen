\doxysection{Ans\+Replayable\+Server.\+h}
\hypertarget{_ans_replayable_server_8h_source}{}\label{_ans_replayable_server_8h_source}\index{commonfiles20.1/PublicItf/AnsReplayableServer.h@{commonfiles20.1/PublicItf/AnsReplayableServer.h}}
\mbox{\hyperlink{_ans_replayable_server_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ COPYRIGHT\ ANSYS.\ ALL\ RIGHTS\ RESERVED}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ \_AnsReplayableServer\_h\_}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ \_AnsReplayableServer\_h\_}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_ans_server_8h}{AnsServer.h}}"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_i_playable_8h}{IPlayable.h}}"{}}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_ans}{Ans}}\ \{}
\DoxyCodeLine{00012\ \textcolor{keyword}{namespace\ }Rpc\ \{}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server}{ReplayableServer}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server}{Server}},\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_i_re_playable}{IRePlayable}}}
\DoxyCodeLine{00015\ \{}
\DoxyCodeLine{00016\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00017\ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server_afd8ada521ea0e6697515e19662f5b40e}{ReplayableServer}}(\textcolor{keyword}{const}\ std::vector<std::string>\ recNames)\ }
\DoxyCodeLine{00018\ \ \ \ \ \{}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_adfff9e92ca2baca4a72ec7020b586d15}{RpcString}}*\ recordingNames;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ recordingNames\ =\ (\mbox{\hyperlink{ansrpc_8h_adfff9e92ca2baca4a72ec7020b586d15}{RpcString}}*)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{ansrpc_8h_adfff9e92ca2baca4a72ec7020b586d15}{RpcString}})\ *\ recNames.size());}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ recNames.size();\ i++)}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ recordingNames[i]\ =\ (\mbox{\hyperlink{ansrpc_8h_adfff9e92ca2baca4a72ec7020b586d15}{RpcString}})recNames[i].c\_str();}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \_player\ =\ \mbox{\hyperlink{ansrpc_8h_a86a7a30b5cd2db4516bf5eaea73009bd}{RpcNewRecordingPlayer}}(recordingNames,\ recNames.size());}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ free(recordingNames);}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_player)}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_rpc_exception}{RpcException}}(\textcolor{stringliteral}{"{}Creating\ recording\ player\ failed"{}});}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_afe1b32bdf8d828580005693f898b026b}{RpcRegistServerRecordingPlayer}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ \_player);}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_a6f2772bed48a0913ca2e4bd8107ecc51}{SetServerMode}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ \mbox{\hyperlink{ansrpc_8h_a813a4804d9efe150ad18f66e8538ce67aa5ddf3a6d46dafb382c86d7e81427a12}{PlayBack}});}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a62409f922cf9a302a117554ff6a4f8cb}{\_servants}}.clear();}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}}\ !=\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}})}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_aa45fcbce00df1b0efdb0f50978f24405}{\_serviceRegistryServant}}\ =\ \mbox{\hyperlink{cxlist_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{00040\ \ \ \ \ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server_abb49735579f879d072bcc5b46dd7c883}{StartReplay}}()}
\DoxyCodeLine{00043\ \ \ \ \ \{}
\DoxyCodeLine{00044\ \ \ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server_a4a971cae48987253ddffe96b08abb01f}{StopReplay}}()}
\DoxyCodeLine{00047\ \ \ \ \ \{}
\DoxyCodeLine{00048\ \ \ \ \ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server_a86acb6465fa8872d4169a4a0acaa01cd}{HasRecords}}()}
\DoxyCodeLine{00051\ \ \ \ \ \{\ \ }
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{ansrpc_8h_adfe323adfe7008c6dea116a0dc95f7a6}{PlayerHasRecords}}(\_player,\ \mbox{\hyperlink{ansrpc_8h_a8fb1b6b95fb5517c5bd1651c1ec58974a42c541d87182788b7128a8052341c0cf}{IsServer}});\ \ }
\DoxyCodeLine{00053\ \ \ \ \ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server_ae96d3aaa8db2c2382118de0198088093}{ReplayARecord}}()}
\DoxyCodeLine{00056\ \ \ \ \ \{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00061\ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server}{ReplayableServer}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server}{ReplayableServer}}\&\ \ anotherServer);}
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server}{ReplayableServer}}\&\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_replayable_server}{ReplayableServer}}\&\ \ anotherServer);}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{void}\ OnClientRequest(\mbox{\hyperlink{ansrpc_8h_aa6f6cd93cb32899541b3ba2ae528e48e}{RpcHandle}}\ channel)}
\DoxyCodeLine{00065\ \ \ \ \ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_request}{Request}}\ request;}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_ans_1_1_rpc_1_1_response}{Response}}\ response;}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ status;}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ request.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_request_a6a2fa0d011b9fd3bb593f4fc4c63fe6c}{Read}}(channel);}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_rpc_request}{RpcRequest}}*\ rpcRequest\ =\ request.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_request_a796f825b203c3a51e42b5aac36f639de}{ToRpcRequest}}();}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_rpc_response}{RpcResponse}}*\ rpcResponse\ =\ \mbox{\hyperlink{ansrpc_8h_a1c55ee46480aa5cca4d1e4d8a0324e47}{RpcNewResponse}}(\mbox{\hyperlink{ansrpc__ftn_8h_a580b065fc8617298151ea278bfcc8647}{kRpcErrorNone}});}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ status\ =\ \mbox{\hyperlink{ansrpc_8h_a436698e00ec76fb247d9a9be2569114d}{RpcGenPlayingBackResponse}}(\mbox{\hyperlink{class_ans_1_1_rpc_1_1_server_a8f78f66572593208a7043944230a83dd}{\_rpcServer}},\ rpcRequest,\ rpcResponse);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (status\ !=\ \mbox{\hyperlink{ansipc_8h_a39e6fa080f33a6e1fd2f9763a3c2a90f}{ANSIPC\_ERROR\_OK}})}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ response.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_response_adbfd27186bf9f0e4d18104c1fb2024c9}{ErrorCode}}\ =\ \mbox{\hyperlink{ansrpc_8h_aa4d3f4755dbcf8c8a9c1a5579a62113cafb5d8e7bf42fb6a4835c3b89a24b4a85}{kRpcErrorVerification}};}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ response.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_response_a44a8c4131b7bcee21fb304256212ac31}{CopyFromRpcResponse}}(rpcResponse);}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ response.\mbox{\hyperlink{class_ans_1_1_rpc_1_1_response_abcaa1eb55cddf729e330acd8a7300b76}{Write}}(channel);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_a561474c73b902789b68cb6d7f5991494}{RpcDeleteRequest}}(rpcRequest);}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ansrpc_8h_af5a8648f7492ca1380a0d5384bea184b}{RpcDeleteResponse}}(rpcResponse);}
\DoxyCodeLine{00085\ \ \ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \mbox{\hyperlink{struct_rpc_recording_player}{RpcRecordingPlayer}}*\ \_player;}
\DoxyCodeLine{00088\ \};}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \}\}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
